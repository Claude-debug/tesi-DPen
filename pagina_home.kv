<PaginaHome>:
    name: "pagina_home"

    BoxLayout:
        orientation: "vertical"
        padding: 10
        spacing: 10
        canvas.before:
            Color:
                rgba: 0.05, 0.05, 0.2, 1  # Blu notte elegante
            Rectangle:
                size: self.size
                pos: self.pos

        # HEADER (TITOLO + MENU)
        BoxLayout:
            size_hint_y: None
            height: "60dp"
            canvas.before:
                Color:
                    rgba: 0.05, 0.05, 0.2, 1
                Rectangle:
                    pos: self.pos
                    size: self.size

            Label:
                text: "Benvenuto in di-PEN"
                font_size: "22sp"
                color: 1, 1, 1, 1
                bold: True
                halign: "center"
                valign: "middle"
                text_size: self.size
            
            Button:
                id: menu_btn
                text: "Menu"
                size_hint_x: 0.2
                background_normal: ""
                background_color: 0, 0, 0, 0
                color: 1, 1, 1, 1
                on_release: root.open_menu(self)
                canvas.before:
                    Color:
                        rgba: 1, 0.65, 0, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [20]

        # BARRA DI RICERCA
        BoxLayout:
            size_hint_y: None
            height: "45dp"
            spacing: "5dp"

            TextInput:
                id: search_input
                size_hint_x: 0.8
                hint_text: "Cerca paziente o iniezione..."
                multiline: False
                background_color: 1, 1, 1, 1
                foreground_color: 0, 0, 0, 1
                on_text: root.on_search(self.text)
                padding: [10, 10, 10, 10]

            Button:
                text: "Cancella"
                size_hint_x: 0.2
                background_normal: ''
                background_color: 0, 0, 0, 0
                color:  0.1, 0.1, 0.3, 1
                on_release: root.clear_search()
                canvas.before:
                    Color:
                        rgba: 0.4, 0.8, 1, 1  # Azzurro sanitario
                    RoundedRectangle:
                        size: self.size
                        pos: self.pos
                        radius: [20]

        # CONTENITORE DINAMICO PER LE TABELLE
        BoxLayout:
            id: content_container
            orientation: "vertical"
            padding: "10dp"
            spacing: "10dp"
            canvas.before:
                Color:
                    rgba: 0.2, 0.2, 0.4, 1
                Rectangle:
                    pos: self.pos
                    size: self.size

            # SCROLLVIEW PER LE TABELLE
            ScrollView:
                GridLayout:
                    id: patients_container
                    cols: 4
                    size_hint_y: None
                    height: self.minimum_height
                    row_default_height: "40dp"
                    row_force_default: True
                    spacing: "5dp"
                    padding: "10dp"
                    canvas.before:
                        Color:
                            rgba: 0.2, 0.2, 0.4, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size

                    # Intestazione della tabella
                    Label:
                        text: "Data"
                        font_size: "18sp"
                        bold: True
                        color: 1, 1, 1, 1
                    Label:
                        text: "Ora"
                        font_size: "18sp"
                        bold: True
                        color: 1, 1, 1, 1
                    Label:
                        text: "Quantit√†"
                        font_size: "18sp"
                        bold: True
                        color: 1, 1, 1, 1
                    Label:
                        text: "Punto"
                        font_size: "18sp"
                        bold: True
                        color: 1, 1, 1, 1

        # BARRA INFERIORE CON PULSANTI
        BoxLayout:
            id: btn_container
            size_hint_y: None
            height: "60dp"
            padding: "10dp"
            spacing: "10dp"
            canvas.before:
                Color:
                    rgba: 0.05, 0.05, 0.2, 1
                Rectangle:
                    pos: self.pos
                    size: self.size

            Button:
                id: btn_home
                text: "HOME"
                font_size: "22sp"
                background_normal: ''
                background_color: 0, 0, 0, 0
                color: 1, 1, 1, 1
                on_release: root.manager.current = "pagina_home"
                size_hint_x: 1
                canvas.before:
                    Color:
                        rgba: 1, 0.6, 0.2, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [20]

            Button:
                id: btn_nuova_iniezione
                text: "Nuova Iniezione"
                font_size: "18sp"
                background_normal: ''
                background_color: 0, 0, 0, 0
                color: 1, 1, 1, 1
                on_release: root.manager.current = "nuova_iniezione"
                size_hint_x: 1
                canvas.before:
                    Color:
                        rgba: 0.3, 0.7, 1, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [20]

            Button:
                id: btn_cambia_password
                text: "Cambia Password"
                font_size: "18sp"
                background_normal: ''
                background_color: 0, 0, 0, 0
                color: 1, 1, 1, 1
                on_release: root.manager.current = "cambia_password"
                size_hint_x: 1
                canvas.before:
                    Color:
                        rgba: 0.2, 0.6, 0.8, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [20]